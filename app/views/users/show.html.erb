<h1><%=user_signed_in? && current_user == @user ? "My" : @user.username + "'s"%> profile</h1>
<%= @user.avatar.attached? ? image_tag(@user.avatar_thumbnail) : image_tag("default_profile.jpg") %>
<br>
<% if user_signed_in? && (current_user == @user)%> 
  <%= link_to "Edit My Profile", edit_user_registration_path %>
<% end %>
<hr>
<div>
  <h2>Challenges Created</h2>
  <% if user_signed_in? && (current_user.id == @user.id) %>
    <%= link_to "Create New Challenge", new_challenge_url, class: "button"%>
  <%end%>

  <table>
    <thead>
      <tr>
        <th>Title</th>
        <th>Submissions</th>
        <th colspan="3"></th>
      </tr>
    </thead>

    <tbody>
      <% @challenges.each do |challenge| %>
        <tr>
          <td><%= challenge.title %></td>
          <td><%= challenge.submissions.size %></td>
          <td><%= link_to 'View', challenge %></td>
          <% if user_signed_in? && (challenge.user == current_user) %>
            <td><%= link_to 'Edit', edit_challenge_path(challenge) %></td>
            <td><%= link_to 'Destroy', challenge, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          <%end%>
        </tr>
      <% end %>
    </tbody>
  </table>
  <% if !@challenges[0] %>
    <p>no challenges</p>
  <%end%>
  <hr>
  <h2>Challenges Completed</h2>
  <table>
    <thead>
      <tr>
        <th>Title</th>
        <th>Submissions</th>
        <th colspan="3"></th>
      </tr>
    </thead>

    <tbody>
      <% @submissions.each do |challenge| %>
        <tr>
          <td><%= challenge.title %></td>
          <td><%= challenge.submissions.size %></td>
          <td><%= link_to 'View', challenge %></td>
          <% if user_signed_in? && (challenge.user == current_user) %>
            <td><%= link_to 'Edit', edit_challenge_path(challenge) %></td>
            <td><%= link_to 'Destroy', challenge, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          <%end%>
        </tr>
      <% end %>
    </tbody>
  </table>
  <% if !@submissions[0] %>
    <p>no submissions</p>
  <%end%>
</div>
